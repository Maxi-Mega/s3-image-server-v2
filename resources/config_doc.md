# Config Documentation

## products

### dynamicData

This section is used to describe data that is evaluated at runtime and can use data from S3 buckets.

#### fileSelectors

File selectors describe the way files are retrieved with a regular expression.
The `kind` field can be:
- _cached_: the file will be cached to disk for faster access from the UI
- _signedURL_: an S3 signed URL will be generated to access the file directly from the UI
- _fullProductSignedURL_: an S3 signed URL will be generated and transformed as follows:
  ```
  # Values from config
  fullProductProtocol="https://external-viewer?url=" # product
  fullProductRootURL="https://s3-server:9000"        # product
  kind="fullProductSignedURL(urlParams)"             # dynamicData.fileSelectors
  urlParams='{"key": "value"}'                       # dynamicData.expressions
  
  # Generated by the S3 server
  signedURL="http://10.10.10.10:9000/bucket/product.tif"
  
  # Resulting URL shown in the UI
  https://external-viewer?key=value&url=https%3A//s3-server%3A9000/bucket/product.tif
  ``` 

If the link field is set to true, an HTTP link pointing to the cached file will be displayed in the UI's image modal files list.
These file selectors can be referenced in `expressions` (see below).

#### expressions

> For more information on expressions, see the Expr Documentation.

Expressions are used to compute values at runtime, based on data such as files from S3 buckets (through `fileSelectors`, see above).
Functions starting with an `_` are custom utility functions and not part of Expr-lang.

The following expressions are considered as "well-known", and are mandatory for the UI to display information correctly:
- `productBasePath`: dir name of the preview file in S3
- `geonames`: geoname data as JSON object
- `localization`: localization data as JSON object
- `productInfo`: JSON object containing the following fields:
  - `title`: preview image title
  - `subtitle`: preview image subtitle
  - `entries`: list of image features (e.g., targets counts)
  - `summary`: specific information displayed in the top panel of the modal window

### dynamicFilters

Dynamic filters are an additional way to show or hide images in the UI, based on arbitrary values produced by expressions.

The name of each filter is used as the dropdown title.
The dropdown entries are computed from the referenced expression, processed for each image.

### imageGroups

Image groups represent the main categories of images, each coming from a single bucket.

Dynamic data defined in groups override data defined in the root `products` section.

#### types

Each group is composed of one or more `types`, allowing to separate images based on their product prefix.
On the UI, these types can be filtered in their parent-group dropdown menu.

Image types inherit and override dynamic data from the parent group.
